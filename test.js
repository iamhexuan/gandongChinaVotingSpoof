var Http = require('http');
var proxyIps = ['180.183.130.112:8080 TH-N - ','198.50.183.168:3128 CA-N! - ','170.178.147.98:8888 US-H-S + ','210.179.209.47:3128 KR-N - ','149.56.17.54:3128 CA-A-S - ','188.93.243.22:8080 RU-N-S - ','192.241.171.39:8080 US-N-S ','178.76.67.44:8080 MD-N-S + ','186.24.33.213:3128 VE-N-S + ','158.181.129.105:8080 KG-N-S - ','182.23.113.209:8080 ID-N! - ','138.59.177.2:8080 HN-N - ','5.197.248.32:8080 AZ-N-S + ','201.20.93.54:8080 BR-N-S - ','52.67.65.122:80 BR-A + ','219.216.96.87:3128 CN-N - ','177.55.253.68:8080 BR-N-S + ','45.33.9.120:80 US-H - ','103.24.127.197:8080 IN-N-S - ','82.165.166.35:80 DE-N-S + ','109.185.180.87:8080 MD-N-S + ','37.187.79.19:3128 FR-A-S + ','182.23.40.122:8080 ID-N-S - ','186.103.193.51:8080 CL-H - ','27.147.221.195:8080 BD-N-S - ','115.166.118.83:8080 ID-N! + ','190.181.18.232:80 BO-N - ','197.149.179.181:8888 TZ-N - ','193.107.247.118:53281 UA-H-S - ','195.189.219.67:8080 RU-N-S + ','131.255.155.138:3128 BR-N-S - ','118.98.216.122:8080 ID-N-S - ','185.86.6.246:3986 TR-N-S + ','173.254.197.117:1080 US-H - ','185.97.132.98:8080 PS-N-S + ','81.201.58.106:8080 CZ-N-S + ','219.127.253.43:80 JP-H - ','82.165.74.38:80 DE-N-S + ','31.47.97.177:8080 CZ-N! - ','46.10.223.92:8080 BG-N - ','219.239.255.188:3128 CN-N-S - ','66.122.95.218:8080 US-N-S - ','198.50.206.0:3128 CA-N + ','182.253.45.57:3128 ID-N-S + ','86.105.52.91:3128 DE-N-S + ','222.165.205.204:8080 ID-N - ','177.87.163.237:8080 BR-N-S ','43.225.23.26:8080 IN-N-S - ','37.57.177.1:8080 UA-N! - ','192.99.128.170:8080 CA-N-S - ','198.50.159.200:8080 CA-N-S + ','83.239.88.170:8080 RU-N-S - ','190.181.135.146:8080 NI-N-S + ','61.129.129.72:8080 CN-N-S! - ','187.16.253.74:3128 BR-N - ','94.141.231.6:8080 RU-N-S - ','202.143.172.46:8080 TH-N-S! + ','192.99.128.170:80 CA-N-S - ','201.20.109.42:3128 BR-N-S - ','189.4.215.67:8080 BR-N-S - ','190.18.134.27:8080 AR-N-S - ','49.236.216.244:8080 ID-N - ','89.40.127.83:3128 DE-N-S + ','184.191.227.194:8080 US-N-S - ','31.162.176.239:8080 RU-N-S + ','178.219.254.16:8080 RU-N-S - ','31.14.134.193:80 IT-N-S + ','89.249.253.10:80 RU-A - ','94.177.160.72:65000 IT-A-S + ','186.101.12.230:80 EC-N-S - ','217.119.125.102:8081 SK-N-S + ','81.214.84.223:8080 TR-N-S + ','52.55.167.173:80 US-H - ','200.71.234.150:8080 AR-N-S! + ','200.182.102.5:3128 BR-N-S! - ','186.192.164.126:80 BR-H - ','94.177.224.103:3128 DE-N + ','80.87.81.102:3128 GH-H - ','36.80.228.77:8080 ID-N + ','194.87.234.253:4489 RU-N-S - ','179.99.244.4:8080 BR-N! - ','77.241.18.10:8080 RU-N - ','114.34.178.242:3128 TW-N + ','41.222.234.58:8080 GH-N - ','94.177.233.31:3128 FR-N-S + ','201.33.234.126:3128 BR-N-S - ','185.46.151.29:8080 UA-N! - ','192.95.46.201:3128 CA-A! ','217.150.38.177:8000 RU-N! + ','40.84.24.155:80 US-A + ','94.20.21.38:3128 AZ-N-S - ','31.43.52.249:3128 UA-N-S! - ','222.124.34.189:8080 ID-N - ','37.57.225.166:8888 UA-N-S + ','186.133.236.196:8080 AR-N-S - ','122.52.133.5:8080 PH-N - ','43.252.199.105:8080 IN-N-S! - ','152.231.29.163:8080 CO-N-S + ','160.202.41.162:8080 ID-N - ','223.68.1.38:8000 CN-N-S + ','186.46.57.90:8080 EC-N-S + ','45.121.216.219:3128 ID-N-S + ','88.225.232.158:8080 TR-N-S! - ','190.219.142.91:3128 PA-N - ','91.198.143.235:8080 UA-N-S + ','186.89.144.118:8080 VE-N - ','182.253.31.66:8080 ID-N-S + ','202.95.152.202:3128 ID-N + ','180.183.163.191:8080 TH-N + ','125.162.90.163:8080 ID-N! + ','200.60.16.230:80 PE-N-S + ','180.250.149.73:8080 ID-N - ','89.185.7.252:8080 UA-N - ','119.29.150.181:3128 CN-N - ','36.81.3.143:8080 ID-N-S - ','154.65.4.90:8080 NG-N - ','41.160.223.252:8080 ZA-N-S + ','117.102.105.122:3128 ID-N - ','36.80.34.225:3128 ID-N-S - ','113.11.46.82:8080 BD-N-S + ','190.7.252.164:8080 AR-N-S - ','173.10.253.25:8080 US-N - ','115.127.72.90:8080 BD-N-S - ','85.236.25.18:9090 RU-N + ','208.72.144.101:8080 US-N-S - ','103.58.73.198:8080 BD-N! - ','125.253.32.158:3128 AU-N-S - ','103.10.223.68:8080 ID-N-S - ','182.138.129.103:3128 CN-A! - ','104.131.36.177:3128 US-N - ','77.240.245.130:8080 LV-N-S - ','178.151.69.119:3128 UA-H + ','106.1.189.64:3128 TW-N + ','212.144.222.27:3128 DE-N-S + ','91.121.195.198:31288 FR-N-S ','94.47.255.26:8080 IT-N - ','116.50.29.193:8989 ID-N! - ','82.165.61.160:80 DE-N-S - ','59.90.100.57:8080 IN-N! - ','183.91.77.50:8080 ID-N - ','62.80.177.210:8080 UA-N-S - ','89.40.118.157:1453 DE-N-S + ','190.238.177.63:8080 PE-N - ','92.217.223.23:80 DE-A - ','185.101.230.115:8080 IR-N-S - ','218.166.179.181:3128 TW-N + ','182.48.93.177:8080 BD-N-S! - ','119.29.149.154:3128 CN-N-S - ','205.134.172.146:8080 US-N - ','139.196.222.157:3128 CN-N - ','202.125.76.50:8080 BD-N + ','121.193.143.249:80 CN-N - ','154.16.127.52:8080 US-N-S + ','197.51.226.6:8080 EG-N! - ','89.40.115.55:2000 FR-N-S + ','181.225.107.178:8080 CO-N-S - ','141.170.196.211:544 BA-N - ','139.0.28.18:8080 ID-N - ','212.227.175.78:80 DE-N-S ','185.55.65.228:8080 PL-N-S + ','203.128.17.1:8081 PK-N-S! + ','217.61.0.85:2003 DE-N-S + ','91.227.77.129:1234 PL-N! - ','177.43.168.66:8080 BR-N-S ','103.26.95.101:8080 TL-A-S - ','212.227.198.69:80 DE-N-S ','222.201.132.32:3128 CN-N + ','84.242.196.13:8080 RU-N - ','184.105.35.50:8080 US-N-S! - ','171.8.79.143:8080 CN-A - ','94.177.243.95:2016 FR-N-S + ','186.93.17.111:8080 VE-A + ','185.64.47.94:8080 RU-N - ','202.129.29.130:8080 TH-N + ','207.249.121.4:80 MX-N! + ','82.165.164.96:80 DE-N-S + ','182.253.123.37:8080 ID-N + ','1.1.176.61:8080 TH-N-S + ','195.110.6.30:8118 UA-H - ','80.88.90.181:80 IT-N-S + ','150.107.141.253:3128 ID-N-S - ','58.243.0.162:9999 CN-N + ','219.238.21.90:3128 CN-N-S - ','68.171.65.230:8081 CA-N - ','177.69.195.4:8080 BR-N-S - ','196.41.123.151:80 ZA-A - ','159.224.83.100:8080 UA-N-S - ','95.80.98.41:8080 RU-N-S + ','177.87.8.50:8080 BR-N-S - ','149.202.152.171:443 GB-N-S + ','201.151.151.222:8080 MX-N-S - ','213.79.104.181:8080 RU-N-S! + ','198.50.195.41:8080 CA-N-S + ','81.219.211.233:8080 PL-N-S! - ','177.104.224.52:3128 BR-N-S + ','213.6.150.178:8080 PS-N - ','184.105.35.51:8080 US-N! - ','202.152.135.6:8080 ID-N - ','138.94.223.30:3128 BR-N-S + ','220.248.230.217:3128 CN-N - ','114.215.150.13:3128 CN-N - ','41.161.78.165:8080 ZA-N + ','187.63.66.70:8080 BR-N-S - ','89.36.221.174:3128 GB-N-S + ','187.60.36.126:3128 BR-N-S - ','200.195.98.114:80 BR-N + ','83.231.34.133:80 ES-N - ','91.98.143.62:80 IR-A - ','190.2.42.177:8080 AR-N - ','182.253.130.22:3128 ID-N-S + ','103.250.185.3:1518 IN-N - ','203.83.176.28:8080 BD-N-S - ','116.48.136.128:8080 HK-N-S - ','150.188.232.243:80 VE-H - ','200.195.167.26:8080 BR-N-S - ','36.80.217.129:8080 ID-N-S - ','202.166.207.152:8080 SG-N + ','67.205.130.114:8080 US-N-S + ','201.38.233.153:8080 BR-N-S - ','202.70.84.163:8080 NP-N-S - ','202.138.241.3:8080 ID-N-S - ','203.217.169.139:8080 KH-N-S + ','176.12.125.198:8080 CZ-N-S - ','159.192.240.69:8080 TH-N-S + ','194.58.36.26:8080 RU-N-S + ','200.10.67.164:8080 PE-N-S - ','52.28.102.81:3128 DE-N + ','185.40.40.198:8080 RU-N-S + ','106.51.186.236:8080 IN-H - ','144.217.40.115:80 CA-N-S + ','95.46.30.18:8080 BY-N-S - ','193.86.229.230:8080 CZ-N + ','191.252.101.145:8080 BR-N-S + ','78.25.118.181:8080 RU-N-S! + ','190.39.92.185:3128 VE-H - ','45.248.147.77:8080 BD-N! - ','182.254.233.21:3128 CN-N-S - ','138.121.52.146:8080 BR-N - ','113.11.87.186:8080 BD-N-S - ','62.176.5.93:8080 RU-N-S + ','186.219.106.4:8080 BR-N-S - ','159.255.163.178:80 IQ-N - ','202.158.39.141:80 ID-H - ','149.202.195.236:443 FR-H + ','137.74.254.198:3128 FR-H - ','208.72.149.241:8080 US-N-S! - ','176.193.78.200:8080 RU-N-S + ','199.201.107.119:3128 US-A-S ','119.9.51.69:8080 AU-N + ','149.210.208.186:3128 NL-A-S - ','101.109.95.95:8080 TH-N-S - ','45.32.115.77:3128 SG-N-S + ','218.66.253.144:80 CN-A-S - ','86.105.51.239:3128 DE-N-S + ','178.249.59.251:8080 RU-N-S + ','219.238.124.221:3128 CN-N - ','181.48.126.134:8080 CO-N + ','212.227.72.191:80 DE-N-S ','212.91.188.166:3128 BG-N-S + ','95.133.163.86:8080 UA-N - ','202.138.238.243:8080 ID-N-S - ','187.84.222.153:80 BR-A - ','202.159.42.246:3128 ID-A-S + ','5.175.78.61:8080 EU-N - ','176.101.177.253:8080 SK-N-S! + ','37.57.111.107:8080 UA-N-S! - ','121.101.134.50:8080 ID-N! - ','94.177.231.171:1993 DE-N-S + ','37.57.216.2:8080 UA-N-S - ','202.72.242.22:8080 MN-N-S - ','202.74.246.84:8080 BD-H-S - ','94.177.229.136:3366 DE-N-S + ','190.90.213.254:8080 CO-N-S! - ','188.213.170.61:3128 IT-N-S - ','217.61.3.240:3128 DE-N-S + ','181.211.191.227:8080 EC-N-S + ','41.242.103.1:3128 MG-N-S! - ','186.250.96.66:8080 BR-N - ','203.130.244.138:3128 ID-N - ','52.53.236.243:8083 US-A - ','177.43.236.170:8080 BR-N-S + ','117.102.100.2:3128 ID-N-S - ','51.254.132.238:80 FR-H + ','212.185.87.53:443 DE-H + ','183.89.196.217:8080 TH-N-S - ','31.186.83.155:3128 PL-N! + ','178.33.236.35:3128 FR-A + ','220.137.113.238:3128 TW-N + ','203.130.233.77:8080 ID-N + ','61.247.186.138:8080 BD-N-S + ','125.161.189.240:3128 ID-H-S + ','188.213.175.227:3128 IT-A + ','190.151.105.178:8080 CL-N-S + ','101.108.51.223:8080 TH-N-S ','24.154.112.20:8080 US-N-S - ','202.138.236.99:8080 ID-N-S! + ','213.57.89.62:18000 IL-H + ','79.104.50.62:3128 RU-N - '];


function voting(){
	
	var numOfVote = proxyIps.length;
	var totalVote = 0;
	var successVote = 0;
	function getProxyIpPort(index){
		var ipPort= proxyIps[index];
		var ip = ipPort.substring(0,ipPort.indexOf(':'));
		var port = ipPort.substring(ipPort.indexOf(':')+1,ipPort.indexOf(' '));
		return [ip, port];
	}

	function checkIfEnded(){
		if (totalVote > 150){
			process.exit(0);
		}
	}

	console.log('new big loop started, and '+numOfVote+' number of vote will be generated');
	numVoted = 0;
	for(var i = 0; i < numOfVote; i++){
		var proxyIpPort = getProxyIpPort(i);
		var req = Http.request({
		    host: proxyIpPort[0],
		    // proxy IP
		    port: +proxyIpPort[1],
		    // proxy port
		    method: 'GET',
		    path: 'http://app2.vote.cntv.cn/makeClickAction.do?voteId=%2015423&items_1130347=191325' // full URL as path
		}, function (res) {
			
		    res.on('data', function (data) {
		        console.log(data.toString());
		        console.log('successVote : ' + (++successVote));
		        totalVote++;
		        checkIfEnded();
		    });
		});
		req.on('error', function(err) {
	    	//ignored
	    	totalVote++;
	    	checkIfEnded();
		});
		req.end();
	}
}

voting();